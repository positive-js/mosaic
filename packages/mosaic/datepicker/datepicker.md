Поле с датой (дейтпикер) — специальное поле с виджетом для ввода даты.

<!-- example(datepicker-overview) -->

### Когда использовать

Используйте дейтпикер для ввода одиночной даты. Если нужно указать диапазон дат, используйте компонент выбора диапазона даты и времени.

Не используйте дейтпикер в тех случаях, когда пользователь точно знает нужную дату. Для ввода даты рождения достаточно простого поля ввода с маской.

### Структура компонента

- Поле ввода
- Маска
- Кнопка открытия виджета
- Виджет с календарем
  - Переключатель года и месяца
  - Кнопки переключения

<div style="margin-top: 15px;"><img src="./assets/images/datepicker/datepicket__structure.jpg" alt="timepicker structure" style="max-width: 633px"/>
</div>

### Описание работы

#### Состояние по умолчанию

Поле пустое, виджет скрыт.

<!-- example(datepicker-overview) -->

#### Фокус с клавиатуры

##### Поле не заполнено

Поле подсвечивается.

Если начать ввод, маска исчезает.

<!-- example(datepicker-overview) -->

##### Поле заполнено

Поле подсвечивается, значение полностью выделяется.

Если начать ввод, значение стирается.

<!-- пример с введенной датой -->

#### Клик в поле с датой

Поле подсвечивается, открывается виджет с текущем месяцем. Каретка ввода остается в поле.

Если поле с датой не заполнено, то после его заполнения в виджете отобразится указанная дата

Если поле с датой заполнено, то во время её изменения, изменения происходят и в виджете

<!-- example(datepicker-overview) -->

#### Выбор даты

В большинстве случаев пользователю достаточно выбрать нужный день. Можно перейти в меню вверху виджета и последовательно выбрать месяц и год. После выбора дня виджет скрывается, результат записывается в поле. Фокус переходит в поле ввода.

<!-- example(datepicker-overview) -->

#### Ручной ввод даты

Пользователь может ввести полную дату вручную. После ввода двух цифр(день или месяц), подставляется точка, каретка перескакивает в следующую часть маски (в месяц или в год). После ввода 4 цифр года, каретка не меняет своего положения, точка не подставляется.

Клавиши ↑ ↓ увеличивают или уменьшают выделенную часть маски (день, месяц или год) на 1. Увеличение/уменьшение затрагивает только выделенную часть маски, например в месяце, за 12, следует 01 и наоборот.

Подробнее про ручной ввод смотри в разделе [Фокус и работа с клавиатурой](/datepicker/overview#фокус-и-работа-с-клавиатурой).

##### Ввод двух цифр года

При вводе значения до 30, то по уходу с поля, подставляется текущее тысячелетие. Например, пользователь ввел дату 12.04.23, то по уходу с поля значение преобразуется в 12.04.2023

При вводе значения более 30, то по уходу с поля, подставляется прошедшее тысячелетие. Например, пользователь ввел дату 12.04.65, то по уходу с поля значение преобразуется в 12.04.1965

<br>
<div class="mc-alert mc-alert_warning">
    <i class="mc mc-icon mc-error_16 mc-alert__icon"></i>
    Нужную вариацию выбирают дизайнер и аналитик в зависимости от задачи
</div>

#### Скрытие виджета

- Кликнуть мимо виджета
- Выбрать день
- Нажать ESC

После закрытия виджета фокус получает поле ввода.

#### Положение виджета

Положение виджета подчиняется правилам позиционирования [дропдаун-меню](/dropdown/overview).

#### Локализация дат

В разных странах приняты разные традиции записи даты: ДД.ММ.ГГГГ в России, ММ/ДД/ГГГГ в США или ДД/ММ/ГГГГ во Франции. Дейтпикер учитывает особенности страны и правильно форматирует значение. Ожидаемый формат даты выводится как плейсхолдер.

<!-- !пример должен быть незаполенным! example(datepicker-language) -->

### Фокус и работа с клавиатурой

<style>
table th:first-of-type {
    width: 35%;
}
table th:nth-of-type(2) {
    width: 65%;
}
</style>

| Клавиша | Действие |
|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span class="hot-key-Button">Tab</span> \ <span class="hot-key-Button">Shift</span> + <span class="hot-key-Button">Tab</span>    | Перевести фокус в/из поле с датой|
| <span class="hot-key-Button">alt</span> + <span class="hot-key-Button">↓</span> | Открыть виджет с календарем |
| <span class="hot-key-Button">alt</span> + <span class="hot-key-Button">↑</span> | Закрыть виджет с календарем |
| <span class="hot-key-Button">Esc</span> | Закрыть виджет |

**Поле с датой**

| Клавиша | Действие |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span class="hot-key-Button">Tab</span>  | Перевести фокус на кнопку открытия виджета |
| <span class="hot-key-Button">↑</span> <span class="hot-key-Button">↓</span>  | Каретка установлена на любой части маски (день, месяц или год) → уменьшение или увеличение значения на 1 |
| <span class="hot-key-Button">→</span>  | Перенести каретку на следующий символ.<br>Если каретка установлена в конце поля ввода, поместить каретку в начало поля ввода |
| <span class="hot-key-Button">←</span>  | Перенести каретку на предыдущий символ.<br>Если каретка установлена в начале поля ввода переместить каретку в конец поля ввода |
| <span class="hot-key-Button">PgDn</span> \ <span class="hot-key-Button">Home</span>  | Поместить каретку в начало поля ввода |
| <span class="hot-key-Button">PgDn</span> \ <span class="hot-key-Button">End</span>  | Поместить каретку в конец поля ввода |
| <span class="hot-key-Button">Space</span>  | - Если в любой части маски(день, месяц или год) → ничего не происходит<br>- Если после ввода двух цифр (день или месяц) → переход к следующей части маски(месяц или год)<br>- Если после ввода одной цифры (в день или месяц) → поле воспринимает эту клавишу как разделитель, подставляется точка, а перед введенной цифрой подставляется ноль |

**Кнопка открытия виджета**

| Клавиша | Действие |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span class="hot-key-Button">Tab</span>  | Перевести фокус к следующему элементу в tab sequence |
| <span class="hot-key-Button">Shift</span> + <span class="hot-key-Button">Tab</span>    | ППеревести фокус на поле с датой |
| <span class="hot-key-Button">Space</span> \ <span class="hot-key-Button">⏎</span>  | Открыть виджет |

### Валидация

#### Проверка во время ввода

**Ввод букв и символов**

Срабатывает [валидация во время ввода значений](/validation/overview#во-время-ввода-значения):

- При вводе букв в любую часть маски;
- При вводе первого символа, кроме цифр, в день или месяц;
- При вводе символа, кроме цифр, в год.

<!-- example(datepicker-overview) -->

**Ввод символов и цифр**

Если после ввода двух цифр (в день или месяц) вводится любой символ, кроме цифр и букв, поле игнорирует этот ввод.

Если после ввода одной цифры (в день или месяц) вводится любой символ, кроме цифр и букв, поле воспринимает этот символ как разделитель и преобразует его в точку, а перед введенной цифрой подставляется ноль.

При вводе значений больше 31 (для дня) и 12 (для месяца), при вводе значения в следующую часть маски, эти значения преобразовываются в 31 (для дня) и 12 (для месяца).

<!-- example(datepicker-overview) -->

#### Проверка при потере фокуса

Если указана одна или три цифры года, поле получается состояние ошибки с текстом: «Укажите две или четыре цифры года».

Если количество введенных дней не соответсвует введеному месяцу, поле получает состояние ошибки с текстом сколько должно быть дней в указанном месяце.

При открытии виджета с календарем, показан текущий год, месяц и день.

<!-- example(datepicker-overview) -->

#### Проверка скопированных значений

При копирование значений из буфера или вставке их с помощью перетаскивания(drag'n'drop), срабатывает [валидация при потери фокуса](/validation/overview#по-уходу-с-поля).

Если в скопированном значении содержались символы, кроме цифр и букв, к ним применяются правила из раздела выше ввод символов и цифр.

На примере ниже, в скопированном значении содержатся:

- Символы * , при вставке в поле с датой, они преобразуются в точки;
- Одна цифра до символа * , при вставке в поле с датой, перед ней добавляется ноль.

<!-- example(datepicker-overview) -->

### Дизайн и анимация

Ширина поля — 130 пикселей.

Размер виджета — w:292; h:248px 